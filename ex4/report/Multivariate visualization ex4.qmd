---
title: "Mutlivariate visualization: continous and continous variable"
format: pdf
lang: en-GB
editor: 
  markdown:
      wrap: 62
---

```{r start libs}

```


```{r start plot}

```


{{< pagebreak >}}


For this exercise, I will visualize distributions over a categorical variable. More specifically, I would like to visualize the distribution of AE over different cognitive states (such as mind wandering and mind blanking). As noted in the previous report, visualizing over categories can be more informative if we expect that one state should result in a different outcome. In our case, we might expect that when people report to be focused on the task that their randomness generation is better, as compared to the other cognitive states. 

Firstly, I load the libraries and transform the data. 

```{r load libraries and data}
library(tidyverse)
library(plotly)
library(patchwork)
library(ggside)
read_csv("../../ex3/data/raw_mwtms_data.csv") -> all_mw_data 
source("../../ex3/src/transformation.R") # AE calculation
```

```{r transform data}
all_mw_data |> 
  select(-region.y) |>
  filter(stimulation == "sham") -> mw_data

da_pro(mw_data, nback=25) -> trans_mw
trans_mw
```

Then we can start by visualizing the distribution over the different cognitive states. I will start with a simple point plot

```{r}
trans_mw |>
  ggplot(aes(x=probe1, y=zlogapen))+
  geom_point(alpha = .2, position = position_jitter(.2))
```

Visualizing data in this way makes it hard to understand the distribution within each category. Although we can clearly see that 3 and 4 have more responses than 1 and 2. That is, the difference between the conditions categories are evident, even though it is not entirely clear whether it is normally distributed. 

To investigate this, we can use histogram and colour them according to the categorical response.

```{r}
trans_mw |> 
  ggplot(aes(x=zlogapen, group=probe1, col=probe1,fill=probe1))+
  geom_histogram(alpha=.3)
```

In this plot the bars are stacked on top of each other, which can make it problematic to see whether the data is distributed normally, especially for the lower probe responses (higher stacked bars). To fix this, we can position the bars beside each other. 

```{r}
trans_mw |> 
  ggplot(aes(x=zlogapen, group=probe1, fill=probe1))+
  geom_histogram(alpha=.3, position = position_dodge(), col="black", size=.15
                 ) -> p_hist 
p_hist
```

With this plot, the distribution within each categorical response is more evident, but regardless, still difficult to read. This can be fixed splitting the distribution, which can be done by using facets.

```{r}
p_hist +
  facet_wrap(~probe1)
```

In this graph, the distribution within each response is clearly evident and easy to read. Moreover, it appears as though the distribution within the first categorical response is flat, at least compared to the other distributions. To further investigate this, we can easily change the distribution to a density. **The density function will summarize the distribution * WILL IT THO?!?!

```{r}
trans_mw |> 
  ggplot(aes(x=zlogapen, group=probe1, fill=probe1, col=probe1))+
  geom_density(alpha=.3,)
```

Alternatively we can use densities, which smoothe the distribution and split by.

```{r}
trans_mw |> 
  #mutate(probe1=as.numeric(probe1)) |>
  ggplot(aes(x=zlogapen, group=probe1, fill=probe1))+
  geom_density(alpha=.3)+
  facet_wrap(~probe1)
```





Or by using facets: 

```{r }
trans_mw |>
  ggplot(aes(x=probe1, y=zlogapen, col=probe1))+
  facet_wrap(~probe1)+
  geom_point(position = position_jitter(.1))
```

On the other hand, we many want to investigate the distribution of data over each variable. Thus we can use the density:

```{r 2d density filled w colour}
trans_mw |> 
  mutate(probe1=as.numeric(probe1)) |>
  ggplot(aes(x=probe1, y=zlogapen))+
  geom_density2d_filled()
```

This plot clearly visualize the distribution of the data compared to the former once. It is difficult to grasp the distribution of the data when it is split over another variable. Alternatively we could show the density over the different categories. 

The former plots do not visualize the distribution of the data easily. Compared to the former plots, this indicate the distribution of the data for each of the variable. 



